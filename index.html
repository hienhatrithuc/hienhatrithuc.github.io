<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Tính lãi suất theo ngày</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        table, th, td {
            border: 1px solid black;
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .highlight {
            background-color: #ffff99;
        }
        .header {
            background-color: #ff9999;
        }
    </style>
    <script>
        function calculate() {
            const lender = document.getElementById('lender').value;
            const borrower = document.getElementById('borrower').value;
            const principal = parseFloat(document.getElementById('principal').value.replace(/,/g, ''));
            const startDate = new Date(document.getElementById('startDate').value);
            const endDate = new Date(document.getElementById('endDate').value);
            const interestPaid = parseFloat(document.getElementById('interestPaid').value.replace(/,/g, ''));
            const totalPaid = principal + interestPaid;

            const daysBorrowed = (endDate - startDate) / (1000 * 60 * 60 * 24) + 1;
            const annualRate = (interestPaid / daysBorrowed) * 360 / principal * 100;
            const monthlyRate = (interestPaid / daysBorrowed) * 30 / principal * 100;
            const dailyRate = (interestPaid / daysBorrowed / principal * 1000000).toFixed(3);

            const multiple = annualRate / 20;
            const excessiveInterest = multiple > 5;

            const illegalProfit = principal * daysBorrowed * ((interestPaid / daysBorrowed / principal * 1000000 - 550) / 1000000);
            const illegalProfitStatus = illegalProfit > 30000000;

            document.getElementById('totalPaid').innerText = totalPaid.toLocaleString('vi-VN') + ' đồng';
            document.getElementById('annualRate').innerText = annualRate.toFixed(2) + '%';
            document.getElementById('monthlyRate').innerText = monthlyRate.toFixed(2) + '%';
            document.getElementById('dailyRate').innerText = dailyRate + ' đ/1 triệu';

            document.getElementById('multiple').innerText = multiple.toFixed(2);
            document.getElementById('excessiveInterest').innerText = excessiveInterest ? 'Cấu thành hành vi lấy lãi gấp 5 lần lãi suất cao nhất theo quy định pháp luật' : 'Chưa cấu thành hành vi lấy lãi cao hơn 5 lần lãi suất cao nhất theo quy định pháp luật';
            document.getElementById('daysBorrowed').innerText = daysBorrowed;
            document.getElementById('illegalProfit').innerText = illegalProfit.toLocaleString('vi-VN') + ' đồng';
            document.getElementById('illegalProfitStatus').innerText = illegalProfitStatus ? 'đủ cấu thành hành vi thu lời bất chính trên 30 triệu đồng' : 'không đủ cấu thành hành vi thu lời bất chính trên 30 triệu đồng';

            document.getElementById('conclusion').innerText = "Ngày " + startDate.toLocaleDateString('vi-VN') + ", " + borrower + " vay của " + lender + " số tiền là " + principal.toLocaleString('vi-VN') + " đồng. Tiền lãi phải trả theo thỏa thuận là " + interestPaid.toLocaleString('vi-VN') + " đồng. " + borrower + " đã nhận số tiền vay là " + principal.toLocaleString('vi-VN') + " đồng, vay từ ngày " + startDate.toLocaleDateString('vi-VN') + " đến ngày " + endDate.toLocaleDateString('vi-VN') + ". " + borrower + " đã trả hoặc phải trả toàn bộ số tiền gốc và tiền lãi cho " + lender + " là " + totalPaid.toLocaleString('vi-VN') + " đồng. Lãi suất của khoản vay là: " + annualRate.toFixed(2) + " đồng/" + principal.toLocaleString('vi-VN') + " đồng x 100%/" + daysBorrowed + " ngày x 365 ngày = " + annualRate.toFixed(2) + "%/năm, gấp " + multiple.toFixed(2) + " lần mức lãi suất cao nhất quy định trong Bộ luật dân sự là 20%/năm; Số tiền lãi/1.000.000 đồng/ngày = " + dailyRate + " đồng/1.000.000 đồng/ngày; Số tiền thu lợi bất chính = " + illegalProfit.toLocaleString('vi-VN') + " đồng x " + daysBorrowed + " ngày x (" + dailyRate + " đồng – 550 đồng)/1.000.000 đồng = " + illegalProfit.toLocaleString('vi-VN') + " đồng";
        }
    </script>
</head>
<body>

<table>
    <tr class="header">
        <th colspan="4">Tính lãi suất theo ngày (trường hợp người vay đã trả hết tiền gốc)</th>
    </tr>
    <tr>
        <td>Người cho vay (ghi họ tên)</td>
        <td><input type="text" id="lender"></td>
        <td>Người vay (ghi họ tên)</td>
        <td><input type="text" id="borrower"></td>
    </tr>
    <tr>
        <td>Số tiền thỏa thuận vay</td>
        <td colspan="3"><input type="text" id="principal" placeholder="Nhập số tiền" onblur="this.value=parseFloat(this.value.replace(/,/g, '')).toLocaleString('vi-VN')"></td>
    </tr>
    <tr>
        <td>Ngày bắt đầu vay</td>
        <td colspan="3"><input type="date" id="startDate"></td>
    </tr>
    <tr>
        <td>Ngày kết thúc vay</td>
        <td colspan="3"><input type="date" id="endDate"></td>
    </tr>
    <tr>
        <td>Tổng tiền lãi đã trả</td>
        <td colspan="3"><input type="text" id="interestPaid" placeholder="Nhập số tiền" onblur="this.value=parseFloat(this.value.replace(/,/g, '')).toLocaleString('vi-VN')"></td>
    </tr>
    <tr class="highlight">
        <td>Tổng số tiền đã trả tiền gốc và tiền lãi là</td>
        <td colspan="3" id="totalPaid"></td>
    </tr>
    <tr>
        <th colspan="4">KẾT QUẢ</th>
    </tr>
    <tr>
        <td>Lãi suất của khoản vay là</td>
        <td>Theo năm (%)</td>
        <td>Theo tháng (%)</td>
        <td>Theo ngày</td>
    </tr>
    <tr>
        <td></td>
        <td id="annualRate"></td>
        <td id="monthlyRate"></td>
        <td id="dailyRate"></td>
    </tr>
    <tr>
        <td>Gấp số lần so với lãi suất cao nhất theo quy định là</td>
        <td colspan="3" id="multiple"></td>
    </tr>
    <tr>
        <td></td>
        <td colspan="3" id="excessiveInterest"></td>
    </tr>
    <tr>
        <td>Số ngày đã vay là</td>
        <td colspan="3" id="daysBorrowed"></td>
    </tr>
    <tr>
        <td>Số tiền thu lợi bất chính</td>
        <td colspan="3" id="illegalProfit"></td>
    </tr>
    <tr>
        <td></td>
        <td colspan="3" id="illegalProfitStatus"></td>
    </tr>
    <tr>
        <th colspan="4">KẾT LUẬN</th>
    </tr>
    <tr>
        <td colspan="4" id="conclusion"></td>
    </tr>
</table>

<button onclick="calculate()">Tính toán</button>

</body>
</html>
